var deps=["jquery","local_keyboard_shortcuts/mousetrap","local_keyboard_shortcuts/tomloprodModal"];define(deps,function(a,b,c){"use strict";function d(a){window.location.href=a}function e(){return decodeURI(window.location.search).replace("?","").split("&").map(function(a){return a.split("=")}).reduce(function(a,b){return b[0]=b[1],a},{})}function f(a){var b=Object.entries(a).filter(function(a){return null!=a[0]&&null!=a[1]}).map(function(a){return a[0]+"="+a[1]}).join("&");return"?"+encodeURI(b)}var g=[{k:"g d",p:"/my"},{k:"g m",p:"/message/index.php"},{k:"g u",p:"/admin/user.php"},{k:"g c",p:"/cohort/index.php"},{k:"g r",p:"/admin/roles/manage.php"},{k:"g p",p:"/admin/plugins.php"}];return{init:function(){g.forEach(function(a){b.bind(a.k,function(){return d(a.p),!1})}),b.bind("s r",function(){var b=window.location.pathname+window.location.search,c=e().id?e().id:"1",g=M.cfg.sesskey;return d(0==a("body.userswitchedrole").length?"/course/switchrole.php"+f({id:c,switchrole:-1,returnurl:b}):"/course/switchrole.php"+f({id:c,sesskey:g,switchrole:0,returnurl:b})),!1}),b.bind("s e",function(){var b=e().id,c=M.cfg.sesskey,g=encodeURI(window.location.pathname+window.location.search),h=1==a("body.editing").length,i=null==b?window.location.pathname:"/course/view.php";return d(i+f({returnurl:g,id:b,sesskey:c,edit:h?"off":"on"})),!1}),b.bind("?",function(){c.openModal("rtfmModal",{})}),b.bind("/",function(){c.openModal("searchModal",{})});var h=[{k:"?",s:"User",d:"Display this help"},{k:"/",s:"User",d:"Search"},{k:"g d",s:"User",d:"Go to dasbhoard"},{k:"g m",s:"User",d:"Go to Messaging page"},{k:"g c",s:"Teacher",d:"Go to cohort mnamgement page"},{k:"s e",s:"Teacher",d:"Switch edition mode on/off"},{k:"g u",s:"Admin",d:"Go to user management page"},{k:"g r",s:"Admin",d:"Go to role management page"},{k:"g p",s:"Admin",d:"Go to plugin management page"},{k:"s r",s:"Admin",d:"Switch role (and back)"}],i=h.map(function(a){return"<tr><td>"+a.k+"</td><td>"+a.s+"</td><td>"+a.d+"</td></tr>"}).join("");a("body").append('<div class="tm-modal tm-effect tm-draggable" id="rtfmModal" style="max-width: 600px"><div class="tm-wrapper"><div class="tm-title"><span class="tm-XButton tm-closeButton"></span><p class="tm-title-text" style="margin-top: 1em;font-size: 35px;color: white;">Help</p></div><div class="tm-contentd"><table style="margin: 30px;width:140%;color: white;"><tr><th>Shortcut</th><th>Scope</th><th>Description</th></tr>'+i+"</table></div></div></div>"),a("body").append('<div class="tm-modal tm-effect tm-draggable" id="searchModal"><div class="tm-wrapper"><span class="tm-XButton tm-closeButton" style="display:none;"></span><div class="tm-content" style="margin: 20px 0px;"><form style="text-align:center;margin:20px 0px;" id="searchContent"><input class="tm-emptyOnClose" placeholder="Search in content" required="" type="text" style="line-height: 30px;padding: 8px 15px;width: 80%;font-size: 17px;" autofocus></form><form style="text-align:center;margin:20px 0px;" id="searchAdmin"><input class="tm-emptyOnClose" placeholder="Search in admin" required="" type="text" style="line-height: 30px;padding: 8px 15px;width: 80%;font-size: 17px;"></form></div></div></div>'),c.start({showMessages:!1,closeOnOverlay:!0,closeOnEsc:!0,draggable:!1,bgColor:"#3498db",textColor:"white",borderRadius:"0.5em",idMainContainer:"page"}),c.registerHandler("opened",function(){setTimeout(function(){a("form#searchContent input").focus(),a("form#searchContent").on("submit",function(b){return d("/course/search.php?search="+a("form#searchContent input")[0].value),b.preventDefault(),!1}),a("form#searchAdmin").on("submit",function(b){return d("/admin/search.php?query="+a("form#searchAdmin input")[0].value),b.preventDefault(),!1})},400)})}}});