!function(a,b){function c(a,b,c){return a.addEventListener?void a.addEventListener(b,c,!1):void a.attachEvent("on"+b,c)}function d(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return q[a.which]?q[a.which]:r[a.which]?r[a.which]:String.fromCharCode(a.which).toLowerCase()}function e(a,b){return a.sort().join(",")===b.sort().join(",")}function f(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}function g(a){return a.preventDefault?void a.preventDefault():void(a.returnValue=!1)}function h(a){return a.stopPropagation?void a.stopPropagation():void(a.cancelBubble=!0)}function i(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function j(){if(!p){p={};for(var a in q)a>95&&a<112||q.hasOwnProperty(a)&&(p[q[a]]=a)}return p}function k(a,b,c){return c||(c=j()[a]?"keydown":"keypress"),"keypress"==c&&b.length&&(c="keydown"),c}function l(a){return"+"===a?["+"]:(a=a.replace(/\+{2}/g,"+plus"),a.split("+"))}function m(a,b){var c,d,e,f=[];for(c=l(a),e=0;e<c.length;++e)d=c[e],t[d]&&(d=t[d]),b&&"keypress"!=b&&s[d]&&(d=s[d],f.push("shift")),i(d)&&f.push(d);return b=k(d,f,b),{key:d,modifiers:f,action:b}}function n(a,c){return null!==a&&a!==b&&(a===c||n(a.parentNode,c))}function o(a){function j(a){a=a||{};var b,c=!1;for(b in u)a[b]?c=!0:u[b]=0;c||(x=!1)}function k(a,b,c,d,f,g){var h,j,k=[],l=c.type;if(!s._callbacks[a])return[];for("keyup"==l&&i(a)&&(b=[a]),h=0;h<s._callbacks[a].length;++h)if(j=s._callbacks[a][h],(d||!j.seq||u[j.seq]==j.level)&&l==j.action&&("keypress"==l&&!c.metaKey&&!c.ctrlKey||e(b,j.modifiers))){var m=!d&&j.combo==f,n=d&&j.seq==d&&j.level==g;(m||n)&&s._callbacks[a].splice(h,1),k.push(j)}return k}function l(a,b,c,d){s.stopCallback(b,b.target||b.srcElement,c,d)||a(b,c)===!1&&(g(b),h(b))}function n(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=d(a);if(b)return"keyup"==a.type&&v===b?void(v=!1):void s.handleKey(b,f(a),a)}function p(){clearTimeout(t),t=setTimeout(j,1e3)}function q(a,b,c,e){function f(b){return function(){x=b,++u[a],p()}}function g(b){l(c,b,a),"keyup"!==e&&(v=d(b)),setTimeout(j,10)}u[a]=0;for(var h=0;h<b.length;++h){var i=h+1===b.length,k=i?g:f(e||m(b[h+1]).action);r(b[h],k,e,a,h)}}function r(a,b,c,d,e){s._directMap[a+":"+c]=b,a=a.replace(/\s+/g," ");var f,g=a.split(" ");return g.length>1?void q(a,g,b,c):(f=m(a,c),s._callbacks[f.key]=s._callbacks[f.key]||[],k(f.key,f.modifiers,{type:f.action},d,a,e),void s._callbacks[f.key][d?"unshift":"push"]({callback:b,modifiers:f.modifiers,action:f.action,seq:d,level:e,combo:a}))}var s=this;if(a=a||b,!(s instanceof o))return new o(a);s.target=a,s._callbacks={},s._directMap={};var t,u={},v=!1,w=!1,x=!1;s._handleKey=function(a,b,c){var d,e=k(a,b,c),f={},g=0,h=!1;for(d=0;d<e.length;++d)e[d].seq&&(g=Math.max(g,e[d].level));for(d=0;d<e.length;++d)if(e[d].seq){if(e[d].level!=g)continue;h=!0,f[e[d].seq]=1,l(e[d].callback,c,e[d].combo,e[d].seq)}else h||l(e[d].callback,c,e[d].combo);var m="keypress"==c.type&&w;c.type!=x||i(a)||m||j(f),w=h&&"keydown"==c.type},s._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)r(a[d],b,c)},c(a,"keypress",n),c(a,"keydown",n),c(a,"keyup",n)}if(a){for(var p,q={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},t={option:"alt",command:"meta","return":"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},u=1;u<20;++u)q[111+u]="f"+u;for(u=0;u<=9;++u)q[u+96]=u.toString();o.prototype.bind=function(a,b,c){var d=this;return a=a instanceof Array?a:[a],d._bindMultiple.call(d,a,b,c),d},o.prototype.unbind=function(a,b){var c=this;return c.bind.call(c,a,function(){},b)},o.prototype.trigger=function(a,b){var c=this;return c._directMap[a+":"+b]&&c._directMap[a+":"+b]({},a),c},o.prototype.reset=function(){var a=this;return a._callbacks={},a._directMap={},a},o.prototype.stopCallback=function(a,b){var c=this;if((" "+b.className+" ").indexOf(" mousetrap ")>-1)return!1;if(n(b,c.target))return!1;if("composedPath"in a&&"function"==typeof a.composedPath){var d=a.composedPath()[0];d!==a.target&&(b=d)}return"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},o.prototype.handleKey=function(){var a=this;return a._handleKey.apply(a,arguments)},o.addKeycodes=function(a){for(var b in a)a.hasOwnProperty(b)&&(q[b]=a[b]);p=null},o.init=function(){var a=o(b);for(var c in a)"_"!==c.charAt(0)&&(o[c]=function(b){return function(){return a[b].apply(a,arguments)}}(c))},o.init(),a.Mousetrap=o,"function"==typeof define&&define.amd&&define(function(){return o})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null);