define(function(){var a=function(){"use strict";function b(a,b,c){[].forEach.call(a,function(a){a.style[b]=c})}function c(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function d(a){try{if(a.getAttribute("data-tm-modal"))return a}catch(b){return b}for(;!a.getAttribute("data-tm-modal");)return d(a.parentNode)}function e(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function f(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].toString()===b.toString())return c;return-1}function g(a,b){a.classList?a.classList.remove(b):"undefined"!=typeof a.className&&(a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))}function h(a,b,c){a.style.left=b+"px",a.style.top=c+"px"}function i(b){b=b||window.event,27===b.keyCode&&a.closeModal()}function j(b){if(b.target!==document.body){var e=d(b.target);e instanceof Element&&c(e,"tm-trigger")&&"undefined"!=typeof e&&(a.openModal(e.getAttribute("data-tm-modal")),b.preventDefault())}}function k(c){for(var d=null,e=0;e<a.modal.attributes.length;e++)if(d=a.modal.attributes[e],/^data-/.test(d.nodeName))switch(d.nodeName){case"data-tm-content":a.modal.getElementsByClassName("tm-content")[0].innerHTML=d.nodeValue;break;case"data-tm-title":a.modal.getElementsByClassName("tm-title-text")[0].innerHTML=d.nodeValue;break;case"data-tm-bgcolor":b(a.modal.getElementsByClassName("tm-wrapper"),"backgroundColor",d.nodeValue);break;case"data-tm-textcolor":b(a.modal.getElementsByClassName("tm-content"),"color",d.nodeValue),b(a.modal.getElementsByClassName("tm-wrapper"),"color",d.nodeValue);break;case"data-tm-closetimer":t=setTimeout(a.closeModal,d.nodeValue)}if("undefined"!=typeof c){var f=null;if("undefined"!=typeof c)for(f in c)if("undefined"!=typeof c[f])switch(f){case"title":a.modal.getElementsByClassName("tm-title-text")[0].innerHTML=c[f];break;case"borderRadius":b(document.getElementsByClassName("tm-wrapper"),"-webkit-border-radius",c[f]),b(document.getElementsByClassName("tm-wrapper"),"-moz-border-radius",c[f]),b(document.getElementsByClassName("tm-wrapper"),"border-radius",c[f]);break;case"content":a.modal.getElementsByClassName("tm-content")[0].innerHTML=c[f];break;case"bgColor":b(a.modal.getElementsByClassName("tm-wrapper"),"backgroundColor",c[f]);break;case"textColor":b(a.modal.getElementsByClassName("tm-content"),"color",c[f]),b(a.modal.getElementsByClassName("tm-wrapper"),"color",c[f]);break;case"closeTimer":t=setTimeout(a.closeModal,c[f])}}}var l=null,m=!0,n=!0,o=!0,p=!1,q={},r=[],s=!1,t=null,u=null;return{modal:[],isOpen:!1,openModal:function(b,d){a.isOpen?a.closeModal():(a.modal=document.getElementById(b),a.modal&&(r&&e(r,"tm-effect"),k(d),n&&c(a.modal,"tm-draggable")&&(a.modal.setAttribute("onmousedown","TomloprodModal.startDragging(this,event);"),a.modal.setAttribute("onmouseup","TomloprodModal.stopDragging(this);")),e(a.modal,"tm-showModal"),l=a.modal.querySelector(".tm-closeButton"),l.addEventListener?l.addEventListener("click",a.closeModal,!1):l.attachEvent&&l.attachEvent("onclick",a.closeModal),o&&!p&&(document.querySelector(".tm-overlay").addEventListener?document.querySelector(".tm-overlay").addEventListener("click",a.closeModal,!1):document.querySelector(".tm-overlay").attachEvent&&document.querySelector(".tm-overlay").attachEvent("onclick",a.closeModal)),m&&(document.onkeyup=i),a.isOpen=!0,a.fire("opened")))},registerHandler:function(a,b){var c=!0;q[a]?f(q[a],b)===-1?q[a].push(b):c=!1:q[a]=[b]},removeHandler:function(a,b){if(!q[a])return!1;if(b=b||!1){var c=f(q[a],b);return c>-1&&(q[a].splice(c,1),!0)}delete q[a]},fire:function(a){if(!q[a])return!1;var b;for(b=0;b<q[a].length;b+=1)q[a][b].apply(window,Array.prototype.slice.call(arguments,1))},create:function(b){if(null===u){u="tm-create"+Math.floor(Date.now()/1e3);var c=document.createElement("DIV");c.id=u,c.className="tm-modal tm-effect tm-draggable";var d=document.createElement("DIV");d.className="tm-wrapper",c.appendChild(d);var e=document.createElement("DIV");e.className="tm-title",d.appendChild(e);var f=document.createElement("SPAN");f.className="tm-XButton tm-closeButton",e.appendChild(f);var g=document.createElement("H3");g.className="tm-title-text",e.appendChild(g);var h=document.createElement("DIV");h.className="tm-content",d.appendChild(h),document.body.insertBefore(c,document.body.firstChild)}a.openModal(u,b)},start:function(a){var c=document.createElement("DIV");c.className="tm-overlay",document.body.appendChild(c);var d=null;if("undefined"!=typeof a)for(d in a)if("undefined"!=typeof a[d])switch(d){case"draggable":n=a[d];break;case"bgColor":b(document.getElementsByClassName("tm-wrapper"),"backgroundColor",a[d]);break;case"borderRadius":b(document.getElementsByClassName("tm-wrapper"),"-webkit-border-radius",a[d]),b(document.getElementsByClassName("tm-wrapper"),"-moz-border-radius",a[d]),b(document.getElementsByClassName("tm-wrapper"),"border-radius",a[d]);break;case"textColor":b(document.getElementsByClassName("tm-content"),"color",a[d]),b(document.getElementsByClassName("tm-wrapper"),"color",a[d]);break;case"closeOnOverlay":o=a[d];break;case"overlayColor":document.querySelector(".tm-overlay").style.backgroundColor=a[d];break;case"removeOverlay":a[d]&&(p=a[d],c=document.querySelector(".tm-overlay"),c&&c.parentNode.removeChild(document.querySelector(".tm-overlay")));break;case"showMessages":s=a[d];break;case"closeOnEsc":m=a[d];break;case"idMainContainer":r=document.getElementById(a[d]),e(r,"tm-MainContainer")}document.addEventListener?document.addEventListener("click",j):document.attachEvent&&document.attachEvent("onclick",j)},stop:function(){document.onclick=null;for(var a=document.getElementsByTagName("A"),b=0;b<a.length;b++){var c=a[b];c.onclick=null}},closeModal:function(b){if("undefined"!=typeof b&&b.stopPropagation(),window.clearTimeout(t),g(r,"tm-effect"),g(a.modal,"tm-showModal"),l.removeEventListener("click",a.closeModal,!1),a.isOpen){var c=a.modal.querySelectorAll(".tm-emptyOnClose"),d=0;for(d=0;d<c.length;d+=1)"INPUT"===c[d].tagName?c[d].value="":c[d].innerHTML=""}a.stopDragging(a.modal),a.modal=[],a.isOpen=!1,a.fire("closed")},startDragging:function(b,c){c=c||window.event,b.style.cursor="move";var d=b.offsetTop,f=b.offsetLeft,g=a.modal.offsetWidth/2,i=a.modal.offsetHeight/2,j=parseInt(window.innerWidth,10),k=parseInt(window.innerHeight,10),l=c.clientX-f,m=c.clientY-d;document.onmousemove=function(c){c=c||window.event;var d=c.clientX-l,f=c.clientY-m;d<g&&(d=g),d+g>j&&(d=j-g),f<i&&(f=i),f+i>k&&(f=k-i),e(document.getElementsByTagName("body")[0],"tm-avoidSelection"),e(a.modal,"tm-avoidSelection"),h(b,d,f)}},stopDragging:function(b){"undefined"!=typeof b.style&&(b.style.cursor="default",g(document.getElementsByTagName("body")[0],"tm-avoidSelection"),g(a.modal,"tm-avoidSelection"),a.fire("stopDragging"),document.onmousemove=function(){})}}}();return a});